id: sap-message-server-tcp-service-detection

info:
  name: SAP Message Server service detection
  author: randomstr1ng
  severity: info
  tags: network,sap,detect
  description: This template will identify the internal (39xx) and external (36xx) tcp service of the SAP Message Server.


tcp:
  - host: 
    - "{{Hostname}}"
    port: 3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3610,3611,3612,3613,3614,3615,3616,3617,3618,3619,3620,3621,3622,3623,3624,3625,3626,3627,3628,3629,3630,3631,3632,3633,3634,3635,3636,3637,3638,3639,3640,3641,3642,3643,3644,3645,3646,3647,3648,3649,3650,3651,3652,3653,3654,3655,3656,3657,3658,3659,3660,3661,3662,3663,3664,3665,3666,3667,3668,3669,3670,3671,3672,3673,3674,3675,3676,3677,3678,3679,3680,3681,3682,3683,3684,3685,3686,3687,3688,3689,3690,3691,3692,3693,3694,3695,3696,3697,3698,3699,3900,3901,3902,3903,3904,3905,3906,3907,3908,3909,3910,3911,3912,3913,3914,3915,3916,3917,3918,3919,3920,3921,3922,3923,3924,3925,3926,3927,3928,3929,3930,3931,3932,3933,3934,3935,3936,3937,3938,3939,3940,3941,3942,3943,3944,3945,3946,3947,3948,3949,3950,3951,3952,3953,3954,3955,3956,3957,3958,3959,3960,3961,3962,3963,3964,3965,3966,3967,3968,3969,3970,3971,3972,3973,3974,3975,3976,3977,3978,3979,3980,3981,3982,3983,3984,3985,3986,3987,3988,3989,3990,3991,3992,3993,3994,3995,3996,3997,3998,3999
    inputs:
      - data: 000000a22a2a4d4553534147452a2a0004004d53475f5345525645522020202020202020202020202020202020202020202020202020202020200000000000000000000000000201707973617027732d64756d706572000000000000000000000000000000000000000000000000000000001e000103020000000000001300000000000000000000000000000000000000000000000000000000000000000000000000000000
        type: hex
    read-size: 2048

    matchers:
      - type: binary
        condition: or
        binary:
          - "4d53475f534552564552004d7367536572766572004554442073656e642050726f787900464e5f5400001e050103"
          - "4d53475f534552564552004d7367536572766572004554442073656e642050726f787900464e5f5400001e000103" # returns a result from internal port
